<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Jangko - Penjelasan Algoritma Deflate Secara Mendalam</title>
    <link rel="stylesheet" href="/stylesheet.css">

    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="Nanoc 4.3.3">
  </head>
  <body>
    <div id="main">
      
<h1 id="struktur-dari-data-yang-telah-dipadatkan-oleh-deflate">Struktur dari data yang telah dipadatkan oleh <em>deflate</em>
</h1>

<p><em>Deflate</em> merupakan algoritma untuk memadatkan data yang sangat populer,
algoritma ini digunakan dalam banyak <em>tools</em> dan <em>library</em> seperti
gzip, zip archiver, konten pdf, bahkan format gambar png yang terkenal juga memakai <em>deflate</em>
sebagai algoritma untuk memadatkan data.</p>

<p>Terkadang kita ingin menulis sendiri algoritma ini dalam bahasa pemrograman yang kita sukai,
namun untuk melakukannya terlebih dahulu harus memahami cara bekerjanya algoritma ini.
Membaca penjelasan dari artikel <a href="https://www.w3.org/Graphics/PNG/RFC-1951">RFC 1951</a> memang salah satu cara untuk memahami algoritma ini,
tetapi menurut saya, penjelasannya masih cukup membingungkan untuk orang yang pertama kali berkenalan dengan algoritma ini.</p>

<p>Oleh karena itu, saya mencoba menyusun artikel ini dan beberapa artikel tambahan untuk memudahkan mengenal
algoritma <em>deflate</em>. Artikelnya disusun dari hal-hal yang paling umum sampai hal-hal yang mendetail,
tidak seperti RFC 1951 yang menyusun hal umum bercampur yang detail sehingga sulit dipahami.</p>

<p>Diharapkan setelah membaca artikel ini beserta artikel pendukungnya, pembaca dapat mengimplementasikan sendiri
algoritma ini dalam bahasa pemrograman yang disukai.</p>

<h2 id="penjelasan-atas-beberapa-istilah-yang-digunakan-dalam-artikel-ini">Penjelasan atas beberapa istilah yang digunakan dalam artikel ini</h2>

<ul>
  <li>
    <p>Byte</p>

    <p>Yang dimaksud dengan byte di artikel ini adalah satu unit data yang terdiri dari delapan bit.
Di dalam satu byte, bit-bit yang ada diberi nomor dari kanan ke kiri sebagai berikut: 76543210</p>
  </li>
  <li>
    <p>Bilangan yang terdiri lebih dari satu byte</p>

    <p>Bila ada bilangan yang terdiri lebih dari satu byte, maka byte pertama yang datang nilainya paling kecil.
Contoh: untuk bilangan yang menggunakan dua byte x08 x02 (heksa) maka x08 nilainya adalah 8 sedangkan x02 nilainya 2 x 256 = 512.
Maka angka x08 x02 akan bernilai 8 + 512 = 520 dalam basis desimal.</p>
  </li>
  <li>
    <p>Menggabungkan bit-bit ke dalam satu byte</p>

    <p>Umumnya data akan disimpan sesuai urutan bitnya yaitu dari kanan ke kiri, akan tetapi untuk <strong>Kode Huffman</strong>,
data disimpan dengan posisi terbalik yaitu mulai dari bit 7 menuju bit 0, atau dari kiri ke kanan.</p>
  </li>
</ul>

<h3 id="struktur-umum">Struktur umum</h3>

<p>Data yang telah dipadatkan menggunakan algoritma <em>deflate</em> berupa serangkaian byte yang panjangnya tak tentu.
Data tersebut kemudian dibagi ke dalam blok-blok yang panjangnya juga tak tentu.
Kecuali untuk blok yang tidak dipadatkan akan memiliki panjang maksimum 65535 byte.
Tentu saja data tersebut minimum boleh terdiri dari satu blok saja.</p>

<p><img src="data-stream.svg" alt="data-stream"></p>

<p>Blok-blok ini tidak musti dimulai pada byte tertentu, atau berakhir pada byte tertentu.
Satu blok bisa dimulai pada pertengahan byte dan berakhir pada pertengahan byte juga.
Batas awal dan batas akhir untuk satu blok ada pada bit, bukan byte.</p>

<h3 id="jenis-jenis-blok">Jenis-jenis blok</h3>
<ul>
  <li>
    <p>Blok yang tidak dipadatkan</p>

    <p>Sesuai namanya, blok ini tidak diapa-apakan, benar-benar data mentah. Panjangnya dibatasi maksimum 65535 byte.
Blok ini terdiri dari header, sub header, dan body. Sub header dan body dimulai pada byte berikutnya.</p>

    <p><img src="uncompressed-block.svg" alt="uncompresses-block"></p>
  </li>
  <li>
    <p>Blok yang dipadatkan menggunakan <em>Fixed Huffman Tree</em></p>

    <p>Blok ini terdiri dari header dan <em>body</em>. <em>Body</em> dimulai pada bit berikutnya,
tidak seperti blok yang tidak dipadatkan, dimana <em>body</em> dimulai pada byte berikut,
sedangkan blok yang dipadatkan <em>body</em> akan dimulai pada bit berikut.</p>

    <p><img src="fixed-block.svg" alt="fixed-block"></p>
  </li>
  <li>
    <p>Blok yang dipadatkan menggunakan <em>Dynamic Huffman Tree</em></p>

    <p>Blok ini terdiri dari header, subheader, <em>Huffman Tree HC</em>, <em>Huffman Tree Alpha</em>, <em>Huffman Tree Delta</em>, dan <em>body</em>.
<em>Huffman Tree HC</em>, <em>Alpha</em>, <em>Delta</em> dan <em>body</em> dimulai pada bit berikutnya.
Sama seperti blok yang dipadatkan menggunakan <em>Fixed Huffman Tree</em>,
<em>body</em> dimulai pada bit berikutnya, bukan byte berikutnya.</p>

    <p><img src="dynamic-block.svg" alt="dynamic-block"></p>
  </li>
</ul>

<h3 id="header"><em>Header</em></h3>
<p>Semua blok diawali dengan sebuah <em>header</em>. <em>Header</em> terdiri dari 3 bit saja.</p>

<ul>
  <li>
    <p>bit pertama adalah BFINAL atau penanda apakah blok ini adalah blok terakhir atau bukan.
Jika nilainya 0 maka ini bukan bit terakhir. Jika nilainya 1, maka ini adalah blok terakhir</p>
  </li>
  <li>
    <p>dua bit berikutnya adalah BTYPE atau jenis blok.</p>

    <ul>
      <li>00 : blok ini tidak dipadatkan</li>
      <li>01 : blok ini dipadatkan menggunakan <em>Fixed Huffman Tree</em>
</li>
      <li>10 : blok ini dipadatkan menggunakan <em>Dynamic Huffman Tree</em>
</li>
      <li>11 : tidak dipakai, atau error</li>
    </ul>

    <p>00, 01, 10, dan 11 adalah bilangan basis dua(biner) yang bila dikonversi ke basis 10(desimal) akan menjadi 0, 1, 2, dan 3</p>

    <p><em>pseudo code</em> berikut akan menjelaskan fungsi BFINAL dan BTYPE saat melakukan <em>decoding</em>(mencairkan data)</p>
  </li>
</ul>

<div class="language-python highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>  BFINAL = false
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>  <span style="color:#080;font-weight:bold">while</span> <span style="color:#080;font-weight:bold">not</span> BFINAL:
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>    BFINAL = data.bacaBit(<span style="color:#00D">1</span>) <span style="color:#777">#baca satu bit dari data</span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>    BTYPE  = data.bacaBit(<span style="color:#00D">2</span>) <span style="color:#777">#baca dua bit dari data</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>    case BTYPE
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>    of TIDAK_DIPADATKAN: <span style="color:#777"># 00</span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>        hasil = data.ambilSaja()
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>    of DIPADATKAN_FIXED_HUFFMAN_TREE: <span style="color:#777">#01</span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>        hasil = data.cairkanMenggunakanFixedHuffmanTree()
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>    of DIPADATKAN_DYNAMIC_HUFFMAN_TREE: <span style="color:#777">#10</span>
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>        hasil = data.cairkanMenggunakanDynamicHuffmanTree()
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>    <span style="color:#080;font-weight:bold">else</span>: error(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">BTYPE ini tidak boleh ada</span><span style="color:#710">"</span></span>)  <span style="color:#777">#11</span>
</pre></div>
</div>
</div>
<p><br></p>

<h3 id="blok-yang-tidak-dipadatkan">Blok yang tidak dipadatkan</h3>

<p>Setelah <em>header</em>, abaikan bit-bit berikut sampai batas byte selanjutnya.
Setelah itu baca dua byte berikutnya sebagai LEN, atau panjang badan blok.
Setelah itu baca lagi dua byte berikutnya sebagai NLEN, atau komplemen dari LEN.</p>

<p>Andaikan blok ini dimulai pada bit 0, maka byte yang berisi <em>header</em> akan tampak seperti ini 76543hhh.
bit 3,4,5,6,7 diabaikan saja, langsung menuju byte berikutnya.</p>

<p>LEN adalah bilangan bulat 16 bit, byte pertama 0-255, byte kedua juga 0-255 tapi nilainya kali 256.
LEN maksimum bernilai 255 + 255 * 256 = 65535.</p>

<p>Demikian pula dengan dengan NLEN, terdiri dari dua byte. Tetapi NLEN adalah komplemen dari LEN.
Maksudnya bit bit pada NLEN adalah kebalikan dari bit-bit pada LEN. Jika LEN terdiri dari 11110000 11110000,
maka NLEN adalah 00001111 00001111.</p>

<p>Untuk memeriksa apakah LEN adalah komplemen dari NLEN, pada kebanyakan bahasa pemrograman bisa digunakan operator <strong>or</strong>,
atau kalau dalam bahasa C bisa gunakan operator <strong><code>|</code></strong>. Operator aritmetik <strong><code>+</code></strong> juga bisa digunakan karena akan
menghasilkan nilai yang sama walaupun definisinya agak beda(kalau dalam bahasa assembly).
Jika hasil operator tersebut tidak sama dengan 0xFFFF atau 65535, maka integritas data diragukan.</p>

<div class="language-python highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>  data.majuHinggaByteBerikutnya()
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>  
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>  <span style="color:#777"># untuk mesin Big Endian dan Little Endian</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>  LEN = data.bacaByte(<span style="color:#00D">1</span>) + data.bacaByte(<span style="color:#00D">1</span>) * <span style="color:#00D">256</span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>  NLEN = data.bacaByte(<span style="color:#00D">1</span>) + data.bacaByte(<span style="color:#00D">1</span>) * <span style="color:#00D">256</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>  <span style="color:#080;font-weight:bold">if</span> LEN <span style="color:#080;font-weight:bold">or</span> NLEN != <span style="color:#00D">65535</span>: error(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">gawat</span><span style="color:#710">"</span></span>)  <span style="color:#777"># baris ini sama dengan baris dibawah</span>
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>  <span style="color:#080;font-weight:bold">if</span> LEN + NLEN != <span style="color:#00D">65535</span>: error(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">gawat</span><span style="color:#710">"</span></span>)
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>  body = data.bacaByte(LEN) <span style="color:#777"># baca data yang tidak dipadatkan sebanyak LEN byte</span>
</pre></div>
</div>
</div>

<p>Jadi sebenarnya, panjang maksimum keseluruhan blok yang tidak dipadatkan tidak hanya 65535 byte,
tetapi ditambah <em>sub header</em> sebanyak 4 byte.
Kemudian ditambah 3 bit <em>header</em>, dan ditambah sekian bit yang diabaikan jika ada.</p>

<h3 id="body-dari-blok-yang-dipadatkan">
<em>Body</em> dari blok yang dipadatkan</h3>

<p>Blok yang dipadatkan menggunakan <em>Fixed Huffman Tree</em> maupun yang dipadatkan menggunakan
<em>Dynamic Huffman Tree</em> mempunyai struktur <em>body</em> yang sama.
<em>Body</em> terdiri dari simbol-simbol yang saya kategorikan α, β, γ, λ, dan δ.
Walaupun simbol-simbol ini tidak terdapat dalam literatur mengenai algoritma <em>deflate</em>,
menurut saya, algoritma <em>deflate</em> lebih mudah dijelaskan jika digunakan kategori untuk membedakan
yang mana simbol, yang mana kode huffman, dan yang mana adalah nilai harfiah.</p>

<p><em>Body</em> dari blok yang dipadatkan akan memiliki jumlah α dan β dalam jumlah tak tentu,
kemudian setiap blok akan diakhiri dengan γ yang merupakan penanda bahwa blok itu sudah berakhir.
Setiap blok hanya memiliki satu simbol γ.</p>

<p>Contoh: ααααβααββγ</p>

<p>Simbol α mewakili Kode Huffman 0-255. Kode Huffman 0-255 juga mewakili nilai harfiah dari byte-byte bernilai 0-255.
Bedanya Kode Huffman 0-255 dengan byte harfiah yang bernilai 0-255 adalah: satu byte selalu delapan bit panjangnya,
sedangakan satu Kode Huffman bisa bervariasi panjang bit-nya, tergantung cara kita membuat/memakai <em>Huffman Tree</em>-nya.</p>

<p>Simbol γ yang merupakan penanda akhir blok mewakili Kode Huffman 256.
Kode Huffman 256 tidak mewakili nilai harfiah manapun, tapi mewakili sebuah action, bahwa pembacaan blok harus diakhiri.</p>

<p>Simbol β mewakili pasangan pengulangan λ dan δ. satu λ selalu diikuti oleh satu δ.</p>

<p>Simbol λ mewakili Kode Huffman 257-285.
Kode Huffman 257-285 ini mewakili banyaknya simbol α sebanyak 3-258 byte.
Tetapi bagaimana kode sebanyak 28 buah(285-257 = 28) bisa mewakili rentang 3-258?</p>

<p>Caranya adalah: sesudah kemunculan λ gunakan tabel dibawah ini untuk menentukan <em>extra bit</em> yang mungkin mengikuti λ.
E<em>xtra bit</em> ini dibaca sama seperti membaca angka integer dengan urutan bit 76543210. Contoh 1110 akan bernilai 14.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Kode Huffman</th>
      <th style="text-align: center"><em>Extra Bit</em></th>
      <th style="text-align: center">Panjang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">257</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">3</td>
    </tr>
    <tr>
      <td style="text-align: center">258</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">4</td>
    </tr>
    <tr>
      <td style="text-align: center">259</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td style="text-align: center">260</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">6</td>
    </tr>
    <tr>
      <td style="text-align: center">261</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">7</td>
    </tr>
    <tr>
      <td style="text-align: center">262</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">8</td>
    </tr>
    <tr>
      <td style="text-align: center">263</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">9</td>
    </tr>
    <tr>
      <td style="text-align: center">264</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">10</td>
    </tr>
    <tr>
      <td style="text-align: center">265</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">11,12</td>
    </tr>
    <tr>
      <td style="text-align: center">266</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">13,14</td>
    </tr>
    <tr>
      <td style="text-align: center">267</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">15,16</td>
    </tr>
    <tr>
      <td style="text-align: center">268</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">17,18</td>
    </tr>
    <tr>
      <td style="text-align: center">269</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">19-22</td>
    </tr>
    <tr>
      <td style="text-align: center">270</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">23-26</td>
    </tr>
    <tr>
      <td style="text-align: center">271</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">27-30</td>
    </tr>
    <tr>
      <td style="text-align: center">272</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">31-34</td>
    </tr>
    <tr>
      <td style="text-align: center">273</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">35-42</td>
    </tr>
    <tr>
      <td style="text-align: center">274</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">43-50</td>
    </tr>
    <tr>
      <td style="text-align: center">275</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">51-58</td>
    </tr>
    <tr>
      <td style="text-align: center">276</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">59-66</td>
    </tr>
    <tr>
      <td style="text-align: center">277</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">67-82</td>
    </tr>
    <tr>
      <td style="text-align: center">278</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">83-98</td>
    </tr>
    <tr>
      <td style="text-align: center">279</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">99-114</td>
    </tr>
    <tr>
      <td style="text-align: center">280</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">115-130</td>
    </tr>
    <tr>
      <td style="text-align: center">281</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">131-162</td>
    </tr>
    <tr>
      <td style="text-align: center">282</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">163-194</td>
    </tr>
    <tr>
      <td style="text-align: center">283</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">195-226</td>
    </tr>
    <tr>
      <td style="text-align: center">284</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">227-257</td>
    </tr>
    <tr>
      <td style="text-align: center">285</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">258</td>
    </tr>
  </tbody>
</table>

<p><br>
Simbol berikutnya yang mengikuti λ adalah δ. Simbol ini mewakili Kode Huffman 0-31.
Akan tetapi hanya 0-29 yang dipakai. Kode 30 dan 31 tidak dipakai. Kode Huffman 0-29 ini mewakili
jarak 1-32.768. Bagaimana 0-29 bisa mewakili 1-32.768?
Kembali kita akan menggunakan <em>extra bit</em> dan menghitung nilainya menggunakan tabel dibawah ini.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Kode Huffman</th>
      <th style="text-align: center"><em>Extra Bit</em></th>
      <th style="text-align: center">Jarak</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">3</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">4</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">5,6</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">7,8</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">9-12</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">13-16</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">17-24</td>
    </tr>
    <tr>
      <td style="text-align: center">9</td>
      <td style="text-align: center">3</td>
      <td style="text-align: center">25-32</td>
    </tr>
    <tr>
      <td style="text-align: center">10</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">33-48</td>
    </tr>
    <tr>
      <td style="text-align: center">11</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">49-64</td>
    </tr>
    <tr>
      <td style="text-align: center">12</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">65-96</td>
    </tr>
    <tr>
      <td style="text-align: center">13</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">97-128</td>
    </tr>
    <tr>
      <td style="text-align: center">14</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center">129-192</td>
    </tr>
    <tr>
      <td style="text-align: center">15</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center">193-256</td>
    </tr>
    <tr>
      <td style="text-align: center">16</td>
      <td style="text-align: center">7</td>
      <td style="text-align: center">257-384</td>
    </tr>
    <tr>
      <td style="text-align: center">17</td>
      <td style="text-align: center">7</td>
      <td style="text-align: center">385-512</td>
    </tr>
    <tr>
      <td style="text-align: center">18</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center">513-768</td>
    </tr>
    <tr>
      <td style="text-align: center">19</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center">769-1024</td>
    </tr>
    <tr>
      <td style="text-align: center">20</td>
      <td style="text-align: center">9</td>
      <td style="text-align: center">1025-1536</td>
    </tr>
    <tr>
      <td style="text-align: center">21</td>
      <td style="text-align: center">9</td>
      <td style="text-align: center">1537-2048</td>
    </tr>
    <tr>
      <td style="text-align: center">22</td>
      <td style="text-align: center">10</td>
      <td style="text-align: center">2049-3072</td>
    </tr>
    <tr>
      <td style="text-align: center">23</td>
      <td style="text-align: center">10</td>
      <td style="text-align: center">3073-4096</td>
    </tr>
    <tr>
      <td style="text-align: center">24</td>
      <td style="text-align: center">11</td>
      <td style="text-align: center">4097-6144</td>
    </tr>
    <tr>
      <td style="text-align: center">25</td>
      <td style="text-align: center">11</td>
      <td style="text-align: center">6145-8192</td>
    </tr>
    <tr>
      <td style="text-align: center">26</td>
      <td style="text-align: center">12</td>
      <td style="text-align: center">8193-12288</td>
    </tr>
    <tr>
      <td style="text-align: center">27</td>
      <td style="text-align: center">12</td>
      <td style="text-align: center">12289-16384</td>
    </tr>
    <tr>
      <td style="text-align: center">28</td>
      <td style="text-align: center">13</td>
      <td style="text-align: center">16385-24576</td>
    </tr>
    <tr>
      <td style="text-align: center">29</td>
      <td style="text-align: center">13</td>
      <td style="text-align: center">24577-32768</td>
    </tr>
  </tbody>
</table>

<p><br></p>

<div class="language-python highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>  <span style="color:#777">#the base lengths represented by codes 257-285</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>  LENGTH_BASE = [<span style="color:#00D">3</span>, <span style="color:#00D">4</span>, <span style="color:#00D">5</span>, <span style="color:#00D">6</span>, <span style="color:#00D">7</span>, <span style="color:#00D">8</span>, <span style="color:#00D">9</span>, <span style="color:#00D">10</span>,
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>    <span style="color:#00D">11</span>, <span style="color:#00D">13</span>, <span style="color:#00D">15</span>, <span style="color:#00D">17</span>, <span style="color:#00D">19</span>, <span style="color:#00D">23</span>, <span style="color:#00D">27</span>, <span style="color:#00D">31</span>, <span style="color:#00D">35</span>, <span style="color:#00D">43</span>, <span style="color:#00D">51</span>,
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>    <span style="color:#00D">59</span>, <span style="color:#00D">67</span>, <span style="color:#00D">83</span>, <span style="color:#00D">99</span>, <span style="color:#00D">115</span>, <span style="color:#00D">131</span>, <span style="color:#00D">163</span>, <span style="color:#00D">195</span>, <span style="color:#00D">227</span>, <span style="color:#00D">258</span>]
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>  <span style="color:#777">#the extra bits used by codes 257-285 (added to base length)</span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>  LENGTH_EXTRA = [<span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">0</span>,
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>    <span style="color:#00D">1</span>, <span style="color:#00D">1</span>, <span style="color:#00D">1</span>, <span style="color:#00D">1</span>, <span style="color:#00D">2</span>, <span style="color:#00D">2</span>, <span style="color:#00D">2</span>, <span style="color:#00D">2</span>, <span style="color:#00D">3</span>, <span style="color:#00D">3</span>, <span style="color:#00D">3</span>, <span style="color:#00D">3</span>,
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>    <span style="color:#00D">4</span>, <span style="color:#00D">4</span>, <span style="color:#00D">4</span>, <span style="color:#00D">4</span>, <span style="color:#00D">5</span>, <span style="color:#00D">5</span>, <span style="color:#00D">5</span>, <span style="color:#00D">5</span>, <span style="color:#00D">0</span>]
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>  <span style="color:#777">#the base backwards distances</span>
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>  <span style="color:#777">#(the bits of distance codes appear after</span>
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>  <span style="color:#777">#length codes and use their own huffman tree)</span>
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>  DISTANCE_BASE = [<span style="color:#00D">1</span>, <span style="color:#00D">2</span>, <span style="color:#00D">3</span>, <span style="color:#00D">4</span>, <span style="color:#00D">5</span>, <span style="color:#00D">7</span>, <span style="color:#00D">9</span>,
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>    <span style="color:#00D">13</span>, <span style="color:#00D">17</span>, <span style="color:#00D">25</span>, <span style="color:#00D">33</span>, <span style="color:#00D">49</span>, <span style="color:#00D">65</span>, <span style="color:#00D">97</span>, <span style="color:#00D">129</span>, <span style="color:#00D">193</span>, <span style="color:#00D">257</span>, <span style="color:#00D">385</span>, <span style="color:#00D">513</span>,
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>    <span style="color:#00D">769</span>, <span style="color:#00D">1025</span>, <span style="color:#00D">1537</span>, <span style="color:#00D">2049</span>, <span style="color:#00D">3073</span>, <span style="color:#00D">4097</span>, <span style="color:#00D">6145</span>, <span style="color:#00D">8193</span>, <span style="color:#00D">12289</span>, <span style="color:#00D">16385</span>, <span style="color:#00D">24577</span>]
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>  <span style="color:#777">#the extra bits of backwards distances (added to base)</span>
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>  DISTANCE_EXTRA = [<span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">0</span>, <span style="color:#00D">1</span>, <span style="color:#00D">1</span>, <span style="color:#00D">2</span>,
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>    <span style="color:#00D">2</span>, <span style="color:#00D">3</span>, <span style="color:#00D">3</span>, <span style="color:#00D">4</span>, <span style="color:#00D">4</span>, <span style="color:#00D">5</span>, <span style="color:#00D">5</span>, <span style="color:#00D">6</span>, <span style="color:#00D">6</span>, <span style="color:#00D">7</span>, <span style="color:#00D">7</span>, <span style="color:#00D">8</span>,
<span class="line-numbers"><a href="#n21" name="n21">21</a></span>    <span style="color:#00D">8</span>, <span style="color:#00D">9</span>, <span style="color:#00D">9</span>, <span style="color:#00D">10</span>, <span style="color:#00D">10</span>, <span style="color:#00D">11</span>, <span style="color:#00D">11</span>, <span style="color:#00D">12</span>, <span style="color:#00D">12</span>, <span style="color:#00D">13</span>, <span style="color:#00D">13</span>]
<span class="line-numbers"><a href="#n22" name="n22">22</a></span>    
<span class="line-numbers"><a href="#n23" name="n23">23</a></span>  <span style="color:#080;font-weight:bold">while</span> true:
<span class="line-numbers"><a href="#n24" name="n24">24</a></span>    kode = data.bacaKodeHuffman(PakaiTreeAlpha)
<span class="line-numbers"><a href="#n25" name="n25">25</a></span>    <span style="color:#080;font-weight:bold">if</span> kode == <span style="color:#00D">256</span>: <span style="color:#080;font-weight:bold">break</span> <span style="color:#777">#keluar dari loop</span>
<span class="line-numbers"><a href="#n26" name="n26">26</a></span>    <span style="color:#080;font-weight:bold">if</span> kode &gt;= <span style="color:#00D">0</span> <span style="color:#080;font-weight:bold">and</span> kode &lt;= <span style="color:#00D">255</span>:  <span style="color:#777"># nilai harfiah</span>
<span class="line-numbers"><a href="#n27" name="n27">27</a></span>      output.tambahkanNilaiHarfiah(kode)
<span class="line-numbers"><a href="#n28" name="n28">28</a></span>    <span style="color:#080;font-weight:bold">if</span> kode &gt;= <span style="color:#00D">257</span> <span style="color:#080;font-weight:bold">and</span> kode &lt;= <span style="color:#00D">285</span>: <span style="color:#777"># ketemu simbol pengulangan</span>
<span class="line-numbers"><a href="#n29" name="n29">29</a></span>      kode = kode - <span style="color:#00D">257</span>  <span style="color:#777"># kurangi 257 supaya bisa digunakan sebagai index array</span>
<span class="line-numbers"><strong><a href="#n30" name="n30">30</a></strong></span>      base = LENGTH_BASE[kode]
<span class="line-numbers"><a href="#n31" name="n31">31</a></span>      <span style="color:#080;font-weight:bold">lambda</span> = base + data.bacaBit(LENGTH_EXTRA[kode])
<span class="line-numbers"><a href="#n32" name="n32">32</a></span>      
<span class="line-numbers"><a href="#n33" name="n33">33</a></span>      kode = data.bacaKodeHuffman(PakaiTreeDelta) 
<span class="line-numbers"><a href="#n34" name="n34">34</a></span>      <span style="color:#777"># kode tidak perlu dikurangi karena bisa langsung digunakan sebagai index</span>
<span class="line-numbers"><a href="#n35" name="n35">35</a></span>      base = DISTANCE_BASE[kode]
<span class="line-numbers"><a href="#n36" name="n36">36</a></span>      delta = base + data.bacaBit(DISTANCE_EXTRA[kode])
<span class="line-numbers"><a href="#n37" name="n37">37</a></span>      output.tambahkanNilaiHarfiahSebanyak(<span style="color:#080;font-weight:bold">lambda</span>).padaPosisi(delta)
</pre></div>
</div>
</div>

<p><br></p>

<p>Baik α, γ, maupun λ di-<em>encode</em> atau dikodekan menggunakan <em>Huffman Tree</em> yang sama.
Sedangankan δ dikodekan dengan <em>Huffman Tree</em> yang berbeda. 
Setiap blok yang dipadatkan akan menggunakan dua <em>Huffman Tree</em> yang saya sebut <em>Huffman Tree Alpha</em> dan <em>Huffman Tree Delta</em>.
Untuk blok yang dipadatkan menggunakan <em>Fixed Huffman Tree</em>, <em>Huffman Tree Alpha</em> dan <em>Delta</em> sudah didefinisikan.</p>

<p>Ini Tabel untuk <em>Huffman Tree Alpha</em>(Fixed), kode 286 dan 287 tidak digunakan.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Kode Huffman</th>
      <th style="text-align: center">Banyaknya Bit</th>
      <th style="text-align: center">Kode Biner</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">0 - 143</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center">00110000 s/d  10111111</td>
    </tr>
    <tr>
      <td style="text-align: center">144 - 255</td>
      <td style="text-align: center">9</td>
      <td style="text-align: center">110010000 s/d 111111111</td>
    </tr>
    <tr>
      <td style="text-align: center">256 - 279</td>
      <td style="text-align: center">7</td>
      <td style="text-align: center">0000000 s/d 0010111</td>
    </tr>
    <tr>
      <td style="text-align: center">280 - 287</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center">11000000 s/d 11000111</td>
    </tr>
  </tbody>
</table>

<p>Untuk <em>Huffman Tree Delta</em>(Fixed) digunakan banyaknya bit yang tetap yaitu 5. 
Perhatikan bahwa Kode Biner Huffman dan Biner Integer pada tabel ini kebetulan sama,
untuk yang <em>Dynamic Huffman Tree</em> tidaklah demikian halnya.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Kode Huffman</th>
      <th style="text-align: center">Banyaknya Bit</th>
      <th style="text-align: center">Kode Biner</th>
      <th style="text-align: center">Biner Integer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">0</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">00000</td>
      <td style="text-align: center">00000</td>
    </tr>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">00001</td>
      <td style="text-align: center">00001</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">00010</td>
      <td style="text-align: center">00010</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">00011</td>
      <td style="text-align: center">00011</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">00100</td>
      <td style="text-align: center">00100</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">00101</td>
      <td style="text-align: center">00101</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">00110</td>
      <td style="text-align: center">00110</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">00111</td>
      <td style="text-align: center">00111</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">01000</td>
      <td style="text-align: center">01000</td>
    </tr>
    <tr>
      <td style="text-align: center">9</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">01001</td>
      <td style="text-align: center">01001</td>
    </tr>
    <tr>
      <td style="text-align: center">10</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">01010</td>
      <td style="text-align: center">01010</td>
    </tr>
    <tr>
      <td style="text-align: center">11</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">01011</td>
      <td style="text-align: center">01011</td>
    </tr>
    <tr>
      <td style="text-align: center">12</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">01100</td>
      <td style="text-align: center">01100</td>
    </tr>
    <tr>
      <td style="text-align: center">13</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">01101</td>
      <td style="text-align: center">01101</td>
    </tr>
    <tr>
      <td style="text-align: center">14</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">01110</td>
      <td style="text-align: center">01110</td>
    </tr>
    <tr>
      <td style="text-align: center">15</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">01111</td>
      <td style="text-align: center">01111</td>
    </tr>
    <tr>
      <td style="text-align: center">16</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10000</td>
      <td style="text-align: center">10000</td>
    </tr>
    <tr>
      <td style="text-align: center">17</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10001</td>
      <td style="text-align: center">10001</td>
    </tr>
    <tr>
      <td style="text-align: center">18</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10010</td>
      <td style="text-align: center">10010</td>
    </tr>
    <tr>
      <td style="text-align: center">19</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10011</td>
      <td style="text-align: center">10011</td>
    </tr>
    <tr>
      <td style="text-align: center">20</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10100</td>
      <td style="text-align: center">10100</td>
    </tr>
    <tr>
      <td style="text-align: center">21</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10101</td>
      <td style="text-align: center">10101</td>
    </tr>
    <tr>
      <td style="text-align: center">22</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10110</td>
      <td style="text-align: center">10110</td>
    </tr>
    <tr>
      <td style="text-align: center">23</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10111</td>
      <td style="text-align: center">10111</td>
    </tr>
    <tr>
      <td style="text-align: center">24</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">11000</td>
      <td style="text-align: center">11000</td>
    </tr>
    <tr>
      <td style="text-align: center">25</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">11001</td>
      <td style="text-align: center">11001</td>
    </tr>
    <tr>
      <td style="text-align: center">26</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">11010</td>
      <td style="text-align: center">11010</td>
    </tr>
    <tr>
      <td style="text-align: center">27</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">11011</td>
      <td style="text-align: center">11011</td>
    </tr>
    <tr>
      <td style="text-align: center">28</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">11100</td>
      <td style="text-align: center">11100</td>
    </tr>
    <tr>
      <td style="text-align: center">29</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">11101</td>
      <td style="text-align: center">11101</td>
    </tr>
    <tr>
      <td style="text-align: center">30</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">11110</td>
      <td style="text-align: center">11110</td>
    </tr>
    <tr>
      <td style="text-align: center">31</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">11111</td>
      <td style="text-align: center">11111</td>
    </tr>
  </tbody>
</table>

<p>Pada blok yang dipadatkan menggunakan <em>Fixed Huffman Tree</em>, 
kedua <em>Huffman Tree</em> yang digunakan yaitu <em>Huffman Tree Alpha</em> dan <em>Delta</em> tidak perlu disertakan dalam blok.
Sedangkan untuk blok yang dipadatkan menggunakan <em>Dynamic Huffman Tree</em>, <em>Huffman Tree Alpha</em> dan <em>Delta</em> perlu disertakan pada blok.</p>

<p>Pada blok yang dipadatkan menggunakan <em>Dynamic Huffman Tree</em>, 
<em>Huffman Tree Alpha</em> dan <em>Delta</em> disimpan dalam bentuk yang sudah dipadatkan.
Dan <em>Huffman Tree</em> yang digunakan untuk memadatkan kedua Tree tersabut adalah <em>Huffman Tree HC</em>. Memang agak memusingkan.</p>

<p><em>Huffman Tree Alpha</em> dan <em>Delta</em> yang dipadatkan menggunakan <em>Huffman Tree HC</em> akan berisi Kode Huffman yang berbeda dengan penjelasan sebelumnya. 
Kali ini Kode Huffman-nya dibagi dalam empat kategori, yaitu:</p>

<ul>
  <li>0-15 mewakili nilai panjang kode biner 0-15</li>
  <li>16 mewakili perintah salin kode sebelumnya sebanyak 3-6 kali, menggunakan bantuan extra 2 bit (00 = 3, 01 = 4, 10 = 5, 11 = 6).</li>
  <li>17 mewakili perintah ulangi menulis nilai 0(<em>zero</em>) sebanyak 3-10 kali dengan bantuan extra 3 bit.</li>
  <li>18 mewakili perintah ulangi menulis nilai 0(<em>zero</em>) sebanyak 11-138 kali dengan bantuan extra 7 bit.</li>
</ul>

<p>Bukankah <em>Hufman Tree Alpha</em> dan <em>Delta</em> yang dipadatkan menggunakan kode 0-287 dan 0-31, 
kenapa nilai <em>Huffman Tree HC</em> yang dipakai cuma 0-15, 
ternyata yang disimpan bukan nilai 0-287(butuh 9 bit) atau 0-31(butuh 5 bit), melainkan panjang kodenya dalam biner. 
Contohnya untuk tabel <em>Huffman Tree Alpha</em>(Fixed) panjang kode binernya adalah 7-9 bit, sedangkan untuk yang <em>Dynamic</em>, 
panjang kode binernya bervariasi antara 0-15 bit. Panjang 0-15 bit inilah yang jadi <em>nilai harfiah</em> untuk <em>Huffman Tree HC</em>.
Dengan menggunakan panjang kode biner ini sudah cukup untuk merekonstruksi <em>Huffman Tree</em>.</p>

<p><em>Huffman Tree HC</em> juga cuma disimpan panjang kode binernya, jadi hanya mengkonsumsi 3 bit(menghasilkan panjang 0-7 bit), 
tidak perlu 5 bit untuk menghasilkan Kode Huffman 0-18.</p>

<p>Hanya saja celakanya, panjang kode biner ini tidak disimpan secara berurutan, melainkan disimpan dengan urutan sebagai berikut:
16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15. 
Kalau panjangnya 0 bit, berarti nilai tersebut tidak digunakan.</p>

<p>Setelah panjang tiap kode sudah dibaca, <em>Huffman Tree</em> bisa direkonstruksi menggunakan cara di artikel <a href="algoritma-huffman.html">Algoritma Huffman</a></p>

<p>Untuk penjelasan mengenai pasangan λ dan δ silakan baca artikel <a href="algoritma-lz77.html">Algoritma LZ77</a></p>

<h3 id="format-data-dari-blok-yang-dipadatkan-dengan-dynamic-huffman-tree">Format data dari blok yang dipadatkan dengan Dynamic Huffman Tree</h3>

<p>OK, sekarang kita akan bahas secara mendetail format data dari blok yang dipadatkan dengan Dynamic Huffman Tree. 
Ini merupakan blok yang paling rumit dan membingungkan, sekaligus paling umum dijumpai dalam kehidupan sehari-hari.</p>

<p>Blok ini, setelah header tiga bit, kita akan menjumpai</p>

<ul>
  <li>5 bit HLIT</li>
  <li>5 bit HDIST</li>
  <li>4 BIT HCLEN</li>
  <li>
    <p><em>Huffman Tree HC</em> yang terdiri dari HCLEN dikali 3 bit. Ingat <em>Huffman Tree HC</em> disusun berdasarkan urutan
16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15.</p>
  </li>
  <li>
<em>Huffman Tree Alpha</em> sebanyak HLIT yang sudah dipadatkan.</li>
  <li>
<em>Huffman Tree Delta</em> sebanyak HDIST yang sudah dipadatkan.</li>
  <li>
<em>Body</em> yang sudah dipadatkan.</li>
  <li>Simbol γ atau Kode Huffman 256 sebagai akhir blok.</li>
</ul>

<p>HLIT seharusnya berisi nilai antara 0-285. Tetapi itu membutuhkan 9 bit. 
Maka untuk menghemat tempat digunakan hanya 5 bit sehingga nilai HLIT yang disimpan dikurangi 257 terlebih dahulu baru disimpan.
HLIT yang dikurangi 257 akan bernilai 0-31 dan cukup menggunakan 5 bit. 
Jadi spesifikasi <em>deflate</em> memaksa kita menggunakan Kode Huffman minimal sebanyak 258(0-257), maksimal 288(0-287).</p>

<p>HDIST juga demikian, harusnya bernilai 1-32 tapi dikurangi 1 baru disimpan sehingga muat dalam 5 bit.</p>

<p>HCLEN harusnya berisi 0-18, tapi untuk menghemat 1 bit, digunakan 4 bit saja setelah HCLEN dikurangi 4.
Jadi spesifikasi <em>deflate</em> memaksa kita menggunakan minimal 5(0-4) dan maksimal 19(0-18) Kode Huffman untuk Tree HC.</p>

<div class="language-python highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>  HC_ORDER = [<span style="color:#00D">16</span>, <span style="color:#00D">17</span>, <span style="color:#00D">18</span>, <span style="color:#00D">0</span>, <span style="color:#00D">8</span>, <span style="color:#00D">7</span>, <span style="color:#00D">9</span>, <span style="color:#00D">6</span>, <span style="color:#00D">10</span>, <span style="color:#00D">5</span>, <span style="color:#00D">11</span>, <span style="color:#00D">4</span>, <span style="color:#00D">12</span>, <span style="color:#00D">3</span>, <span style="color:#00D">13</span>, <span style="color:#00D">2</span>, <span style="color:#00D">14</span>, <span style="color:#00D">1</span>, <span style="color:#00D">15</span>]
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>  HLIT  = data.bacaBit(<span style="color:#00D">5</span>) + <span style="color:#00D">257</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>  HDIST = data.bacaBit(<span style="color:#00D">5</span>) + <span style="color:#00D">1</span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>  HCLEN = data.bacaBit(<span style="color:#00D">4</span>) + <span style="color:#00D">4</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>  
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>  <span style="color:#080;font-weight:bold">for</span> i <span style="color:#080;font-weight:bold">in</span> <span style="color:#60E">0.</span>.HCLEN:
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>    TreeHC_len[HC_ORDER[i]] = data.bacaBit(<span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>  
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>  <span style="color:#777">#kita abaikan rekonstruksi TreeHC untuk penyederhanaan</span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>  
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>  <span style="color:#080;font-weight:bold">for</span> i <span style="color:#080;font-weight:bold">in</span> <span style="color:#60E">0.</span>.HLIT:
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>    TreeAlpha_len[i] = data.bacaKodeHuffman(PakaiTreeHC)
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>    
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>  <span style="color:#080;font-weight:bold">for</span> i <span style="color:#080;font-weight:bold">in</span> <span style="color:#60E">0.</span>.HDIST:
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>    TreeDelta_len[i] = data.bacaKodeHuffman(PakaiTreeHC)
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>    
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>  <span style="color:#777">#kita abaikan rekonstruksi TreeAlpha dan TreeDelta</span>
</pre></div>
</div>
</div>

<p>Setelah itu baca body pakai TreeAlpha dan TreeDelta sampai ketemu kode 256(γ).
Caranya sama seperti membaca body yang dipadatkan dengan <em>Fixed Huffman Tree</em>, 
hanya saja TreeAlpha dan TreeDelta direkonstruksi dari blok data, bukan dari tabel yang Fixed.</p>

    </div>
    <div id="sidebar">
      <h2>Deflate</h2>
      <ul>
        <li><a href="http://nanoc.ws/about/">Struktur data Deflate</a></li>
        <li><a href="http://nanoc.ws/doc/">Algoritma Huffman</a></li>
        <li><a href="http://nanoc.ws/doc/tutorial/">Algoritma LZ77</a></li>        
        <li><a href="http://nanoc.ws/about/">Algoritma Package-Merge</a></li>
        <li><a href="http://nanoc.ws/about/">Algoritma Deflate</a></li>
        <li><a href="http://nanoc.ws/about/">zlib dan gzip</a></li>
      </ul>
      <h2>JPEG</h2>
      <ul>
        <li><a href="http://nanoc.ws/about/">Color Space Conversion</a></li>
        <li><a href="http://nanoc.ws/doc/">JPEG Quantization Table</a></li>
        <li><a href="http://nanoc.ws/doc/tutorial/">JPEG Huffman Coding</a></li>        
        <li><a href="http://nanoc.ws/about/">Chroma Subsampling</a></li>
        <li><a href="http://nanoc.ws/about/">JPEG Encoder Design</a></li>
        <li><a href="http://nanoc.ws/about/">JPEG Optimization</a></li>
        <li><a href="http://nanoc.ws/about/">JPEG Decoder Design</a></li>
      </ul>
      <h2>Kode Sumber</h2>
      <ul>
        <li><a href="http://groups.google.com/group/nanoc/">Discussion group</a></li>
        <li><a href="irc://chat.freenode.net/#nanoc">IRC channel</a></li>
        <li><a href="http://nanoc.ws/contributing/">Contributing</a></li>
      </ul>
    </div>
  </body>
</html>
